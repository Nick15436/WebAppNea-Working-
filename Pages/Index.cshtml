@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<div class="container-fluid bg-black text-light pt-3">

    <!-- Row 1: Top Menu -->
    <div class="row">
        <!-- 
            ADDED: 'bg-dark', 'p-3', 'rounded'
            This creates the dark rectangle with padding and rounded corners.
        -->
        <div class="col-12 bg-dark p-3 rounded d-flex justify-content-between align-items-center">
           
            <ul class="nav nav-underline mb-0" data-bs-theme="dark">
                <li class="nav-item">
                    <a class="nav-link @(Model.ActiveTicker == "AAPL" ? "active" : "")" href="/?ticker=AAPL">AAPL</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(Model.ActiveTicker == "GOOG" ? "active" : "")" href="/?ticker=GOOG">GOOG</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(Model.ActiveTicker == "AMZN" ? "active" : "")" href="/?ticker=AMZN">AMZN</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(Model.ActiveTicker == "MSFT" ? "active" : "")" href="/?ticker=MSFT">MSFT</a>
                </li>
            </ul>


            <div>
                <!-- 'btn btn-primary' makes the button blue with white text -->
                <a href="#" class="btn btn-primary">Log In</a>
                <!-- 'ms-2' adds a small margin (margin-start) between the buttons -->
                <a href="#" class="btn btn-primary ms-2">History</a>
            </div>
            
        </div>
    </div>

    <!-- Row 2: Chart -->
    <div class="row mt-3 justify-content-center">
        
        <div class="col-md-10">

            @if (Model.ApiDataIsNull)
            {
                <p> Request limit hit. Data displayed is NOT REAL-TIME. </p>
            }

            <div id="main" style="width: 100%; height:650px;"></div>
        </div>
    </div>

    <!-- Row 3: Bottom Menu -->
    <div class="row mt-3">
        <div class="col-12 bg-dark text-light p-3 justify-content-between align-items-center">
            
            <h5>Area for text:</h5>
            <ul>
                <li>show the timezone of the chart</li>
                <li>display what different models show about the data</li>
                <li>show whether the user should buy / sell overall</li>
                <li><strong>Current Model:</strong> 
                    @{
                        string displayModel;
                        switch (Model.CurrentPrediction)
                        {
                            case "MovingAverage":
                                displayModel = "Simple Moving Average";
                                break;
                            case "MachineLearningRegression":
                                displayModel = "Machine Learning Regression";
                                break;
                            case "MachineLearningClassification":
                                displayModel = "Machine Learning Classification";
                                break;
                            case "LinearRegression":
                                displayModel = "Linear regression";
                                break;
                            case "EnsembleModel":
                                displayModel = "Ensemble Model";
                                break;
                            default:
                                displayModel = Model.CurrentPrediction; 
                                break;
                        }
                    }
                    @displayModel
                </li>
            </ul>
            @{
                if (Model.CurrentPrediction == "MachineLearningClassification")
                {
                    <p>
                        @Model.ClassificationScores;
                    </p>   
                } 
            }
            
            
            <div class="col-1 dropdown">
                
                <button class="btn btn-info dropdown-toggle" type="button" id="predictionDropdown" data-bs-toggle="dropdown" data-bs-strategy="fixed" aria-expanded="false">
                    Change Prediction Model
                </button>
                
                <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="predictionDropdown" data-bs-theme="dark">
                    <li><a class="dropdown-item @(Model.CurrentPrediction == "Naive" ? "active" : "")" href="/?ticker=@Model.ActiveTicker&prediction=Naive">Naive</a></li>
                    <li><a class="dropdown-item @(Model.CurrentPrediction == "MovingAverage" ? "active" : "")" href="/?ticker=@Model.ActiveTicker&prediction=MovingAverage">Simple Moving Average</a></li>
                    <li><a class="dropdown-item @(Model.CurrentPrediction == "MachineLearningRegression" ? "active" : "")" href="/?ticker=@Model.ActiveTicker&prediction=MachineLearningRegression">ML Regression</a></li>
                    <li><a class="dropdown-item @(Model.CurrentPrediction == "MachineLearningClassification" ? "active" : "")" href="/?ticker=@Model.ActiveTicker&prediction=MachineLearningClassification">ML Classification</a></li>
                </ul>
            </div>
        </div>
    </div>

</div>


<script type="text/javascript">
    // Initialise the echarts instance based on the prepared dom
    var myChart = echarts.init(document.getElementById('main'), 'dark');

    // Specify the configuration items and data for the chart
    var option = {

        dataZoom: { type: 'slider' },

        grid:
        {
            // Set grid width to be responsive within its container
            width: '90%', 
            left: '5%'
        },

        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'line'
            }
        },

        xAxis: {
            // The Asp library replaces certain characters with the corresponding html code in order to "help".
            //  Html.Raw tells the Asp to not help.
            data: @Html.Raw(Model.LabelsData)
        },
        yAxis: {},
        series: [
            {
                type: 'candlestick',
                data: @Html.Raw(Model.CandlesData),

                itemStyle: {
                    color: '#00da3c',       // Bullish (Up) -> Green
                    color0: '#ec0000',      // Bearish (Down) -> Red
                    borderColor: '#00da3c', // Border for Up candle
                    borderColor0: '#ec0000' // Border for Down candle
                }
            }
        ]
    };

    // Display the chart using the configuration items and data just specified.
    myChart.setOption(option);

    // Make the chart resize with the window (important for responsive design)
    window.addEventListener('resize', myChart.resize);

</script>